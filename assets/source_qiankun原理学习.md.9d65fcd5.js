import{_ as s,c as n,o as a,e as l}from"./app.c7796e3f.js";const A=JSON.parse('{"title":"qiankun åŸç†å­¦ä¹ ","description":"","frontmatter":{},"headers":[{"level":2,"title":"qiankun çš„ç‰¹ç‚¹","slug":"qiankun-çš„ç‰¹ç‚¹","link":"#qiankun-çš„ç‰¹ç‚¹","children":[{"level":3,"title":"qiankun å’Œ single-spa çš„åŒºåˆ«","slug":"qiankun-å’Œ-single-spa-çš„åŒºåˆ«","link":"#qiankun-å’Œ-single-spa-çš„åŒºåˆ«","children":[]},{"level":3,"title":"qiankun registerMicoApp","slug":"qiankun-registermicoapp","link":"#qiankun-registermicoapp","children":[]}]},{"level":2,"title":"å¿«é€Ÿå­¦ä¹ ä¹¾å¤å®ç°æµç¨‹","slug":"å¿«é€Ÿå­¦ä¹ ä¹¾å¤å®ç°æµç¨‹","link":"#å¿«é€Ÿå­¦ä¹ ä¹¾å¤å®ç°æµç¨‹","children":[{"level":3,"title":"qiankun çš„æ•´ä¸ªæµç¨‹","slug":"qiankun-çš„æ•´ä¸ªæµç¨‹","link":"#qiankun-çš„æ•´ä¸ªæµç¨‹","children":[]},{"level":3,"title":"åŠ è½½è§£æ html","slug":"åŠ è½½è§£æ-html","link":"#åŠ è½½è§£æ-html","children":[]},{"level":3,"title":"css å¤–éƒ¨æ ·å¼å¤„ç†","slug":"css-å¤–éƒ¨æ ·å¼å¤„ç†","link":"#css-å¤–éƒ¨æ ·å¼å¤„ç†","children":[]},{"level":3,"title":"js æ²™ç®±å¤„ç†","slug":"js-æ²™ç®±å¤„ç†","link":"#js-æ²™ç®±å¤„ç†","children":[]},{"level":3,"title":"åŠ è½½å¤–éƒ¨ js èµ„æº","slug":"åŠ è½½å¤–éƒ¨-js-èµ„æº","link":"#åŠ è½½å¤–éƒ¨-js-èµ„æº","children":[]},{"level":3,"title":"ä»å…¥å£æ–‡ä»¶è·å–ç”Ÿå‘½å‘¨æœŸé’©å­å‡½æ•°","slug":"ä»å…¥å£æ–‡ä»¶è·å–ç”Ÿå‘½å‘¨æœŸé’©å­å‡½æ•°","link":"#ä»å…¥å£æ–‡ä»¶è·å–ç”Ÿå‘½å‘¨æœŸé’©å­å‡½æ•°","children":[]}]},{"level":2,"title":"qiankun js æ²™ç®±å…·ä½“å®ç°æ€è·¯","slug":"qiankun-js-æ²™ç®±å…·ä½“å®ç°æ€è·¯","link":"#qiankun-js-æ²™ç®±å…·ä½“å®ç°æ€è·¯","children":[{"level":3,"title":"SnapshotSandbox å¿«ç…§æ²™ç®±","slug":"snapshotsandbox-å¿«ç…§æ²™ç®±","link":"#snapshotsandbox-å¿«ç…§æ²™ç®±","children":[]},{"level":3,"title":"LegacySandbox å•ä¾‹æ²™ç®±","slug":"legacysandbox-å•ä¾‹æ²™ç®±","link":"#legacysandbox-å•ä¾‹æ²™ç®±","children":[]},{"level":3,"title":"ProxySandbox å¤šä¾‹æ²™ç®±","slug":"proxysandbox-å¤šä¾‹æ²™ç®±","link":"#proxysandbox-å¤šä¾‹æ²™ç®±","children":[]},{"level":3,"title":"js æ²™ç®±æ€»ç»“","slug":"js-æ²™ç®±æ€»ç»“","link":"#js-æ²™ç®±æ€»ç»“","children":[]}]},{"level":2,"title":"qiankun css æ²™ç®±å…·ä½“å®ç°æ€è·¯","slug":"qiankun-css-æ²™ç®±å…·ä½“å®ç°æ€è·¯","link":"#qiankun-css-æ²™ç®±å…·ä½“å®ç°æ€è·¯","children":[{"level":3,"title":"shadow Dom æ²™ç®±","slug":"shadow-dom-æ²™ç®±","link":"#shadow-dom-æ²™ç®±","children":[]},{"level":3,"title":"scoped Css æ²™ç®±","slug":"scoped-css-æ²™ç®±","link":"#scoped-css-æ²™ç®±","children":[]},{"level":3,"title":"qiankun css è§£å†³æ–¹æ¡ˆ","slug":"qiankun-css-è§£å†³æ–¹æ¡ˆ","link":"#qiankun-css-è§£å†³æ–¹æ¡ˆ","children":[]}]}],"relativePath":"source/qiankunåŸç†å­¦ä¹ .md","lastUpdated":1678073130000}'),p={name:"source/qiankunåŸç†å­¦ä¹ .md"},o=l(`<h1 id="qiankun-åŸç†å­¦ä¹ " tabindex="-1">qiankun åŸç†å­¦ä¹  <a class="header-anchor" href="#qiankun-åŸç†å­¦ä¹ " aria-hidden="true">#</a></h1><ul><li><a href="https://qiankun.umijs.org/zh/guide" target="_blank" rel="noreferrer">qiankun å®˜ç½‘</a></li></ul><h2 id="qiankun-çš„ç‰¹ç‚¹" tabindex="-1">qiankun çš„ç‰¹ç‚¹ <a class="header-anchor" href="#qiankun-çš„ç‰¹ç‚¹" aria-hidden="true">#</a></h2><ul><li>ğŸ“¦ åŸºäº single-spa å°è£…ï¼Œæä¾›äº†æ›´åŠ å¼€ç®±å³ç”¨çš„ APIã€‚</li><li>ğŸ“± æŠ€æœ¯æ ˆæ— å…³ï¼Œä»»æ„æŠ€æœ¯æ ˆçš„åº”ç”¨å‡å¯ ä½¿ç”¨/æ¥å…¥ã€‚</li><li>ğŸ’ª HTML Entry æ¥å…¥æ–¹å¼ï¼Œè®©ä½ æ¥å…¥å¾®åº”ç”¨åƒä½¿ç”¨ iframe ä¸€æ ·ç®€å•ã€‚</li><li>ğŸ›¡â€‹ æ ·å¼éš”ç¦»ï¼Œç¡®ä¿å¾®åº”ç”¨ä¹‹é—´æ ·å¼äº’ç›¸ä¸å¹²æ‰°ã€‚</li><li>ğŸ§³ JS æ²™ç®±ï¼Œç¡®ä¿å¾®åº”ç”¨ä¹‹é—´ å…¨å±€å˜é‡/äº‹ä»¶ ä¸å†²çªã€‚</li><li>âš¡ï¸ èµ„æºé¢„åŠ è½½ï¼Œåœ¨æµè§ˆå™¨ç©ºé—²æ—¶é—´é¢„åŠ è½½æœªæ‰“å¼€çš„å¾®åº”ç”¨èµ„æºï¼ŒåŠ é€Ÿå¾®åº”ç”¨æ‰“å¼€é€Ÿåº¦ã€‚</li></ul><h3 id="qiankun-å’Œ-single-spa-çš„åŒºåˆ«" tabindex="-1">qiankun å’Œ single-spa çš„åŒºåˆ« <a class="header-anchor" href="#qiankun-å’Œ-single-spa-çš„åŒºåˆ«" aria-hidden="true">#</a></h3><blockquote><p>qiankun æ˜¯åŸºäº single-spa å°è£…çš„</p></blockquote><div class="warning custom-block"><p class="custom-block-title">WARNING</p><ul><li><p>single-spa çš„æ€æƒ³ï¼š single-spa è®¤ä¸ºä»»ä½•ä¸€ä¸ª web å‰ç«¯åº”ç”¨éƒ½å¯ä»¥è¢«æ‰“åŒ…æˆä¸€ä¸ª js æ¨¡å—ï¼Œè¿™æ ·çš„è¯å¯¹äºä¸€ä¸ªå·¨çŸ³åº”ç”¨æ¥è¯´ï¼Œå°±å¯ä»¥æ‹†åˆ†æˆä¸€ä¸ªä¸»åº”ç”¨ + è‹¥å¹²ä¸ªå­åº”ç”¨ï¼ˆjs æ¨¡å—ï¼‰ï¼Œåœ¨ä¸»åº”ç”¨é€šè¿‡ jsonp çš„æ–¹å¼è¯·æ±‚å¯¹åº”çš„ js æ¨¡å—(å­åº”ç”¨), å¹¶å°†å…¶æ’å…¥åˆ°ä¸»åº”ç”¨å³å¯å®ç°å·¨çŸ³åº”ç”¨çš„æ‹†åˆ†</p></li><li><p>qiankun çš„æ€æƒ³ï¼šqiankun æ˜¯åŸºäº single-spa å®ç°çš„ï¼Œåº•å±‚çš„ api ç”¨çš„éƒ½æ˜¯ single-spa çš„ apiï¼Œä½†æ˜¯é’ˆå¯¹ single-spa çš„ç¼ºç‚¹è¿›è¡Œäº†ä¼˜åŒ–ã€‚</p><ol><li>qiankun è®¤ä¸ºæ‰“åŒ…åçš„å…¥å£æ–‡ä»¶ä¸åº”è¯¥æ˜¯ js æ¨¡å—ï¼Œè€Œæ˜¯ä¸€ä¸ª html æ–‡ä»¶</li><li>é’ˆå¯¹ single-spa æ²¡æœ‰ js éš”ç¦»å’Œ css éš”ç¦»çš„ç¼ºé™·ï¼Œä¸ºæˆ‘ä»¬æä¾›äº† 3 ç§ js æ²™ç®±å’Œ 2 ç§ css æ²™ç®±ç”¨äºéš”ç¦» js å’Œ css</li><li>ç®€åŒ–äº†ä¸»åº”ç”¨å’Œå­åº”ç”¨çš„æ¥å…¥æˆæœ¬ï¼Œä¸ºæˆ‘ä»¬æä¾›æ›´ç®€ä¾¿çš„ api</li><li>ä¸ºæˆ‘ä»¬æä¾›äº†å­åº”ç”¨é¢„åŠ è½½å’Œå­åº”ç”¨ç¼“å­˜çš„åŠŸèƒ½</li></ol></li></ul></div><table><thead><tr><th></th><th>æ³¨å†Œå­åº”ç”¨çš„ api</th><th>è¯·æ±‚çš„èµ„æº</th><th>æ”¯æŒå­åº”ç”¨é¢„åŠ è½½</th><th>æ”¯æŒå­åº”ç”¨ç¼“å­˜</th></tr></thead><tbody><tr><td>single-spa</td><td>registerApplication</td><td>js</td><td>ä¸æ”¯æŒ</td><td>ä¸æ”¯æŒ</td></tr><tr><td>qiankun</td><td>registerMicoApp</td><td>html</td><td>æ”¯æŒ</td><td>æ”¯æŒ</td></tr></tbody></table><p>registerMicoApp æ˜¯å¯¹ registerApplication è¿›è¡Œäº†ä¸€æ¬¡å°è£…</p><h3 id="qiankun-registermicoapp" tabindex="-1">qiankun registerMicoApp <a class="header-anchor" href="#qiankun-registermicoapp" aria-hidden="true">#</a></h3><p>é¦–å…ˆå°±æ˜¯ registerMicoApp çš„ä½¿ç”¨</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#82AAFF;">registerMicroApps</span><span style="color:#A6ACCD;">([</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">app1</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">entry</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">//localhost:8080</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">container</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">#container</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">activeRule</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/react</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">props</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">a</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#A6ACCD;">])</span></span>
<span class="line"></span></code></pre></div><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">let</span><span style="color:#A6ACCD;"> microApps</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Array</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">RegistrableApp</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">Record</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">string</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">unknown</span><span style="color:#89DDFF;">&gt;&gt;&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> []</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">registerMicroApps</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">T</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">extends</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">ObjectType</span><span style="color:#89DDFF;">&gt;(</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#A6ACCD;font-style:italic;">apps</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Array</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">RegistrableApp</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">T</span><span style="color:#89DDFF;">&gt;&gt;,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#A6ACCD;font-style:italic;">lifeCycles</span><span style="color:#89DDFF;">?:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">FrameworkLifeCycles</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">T</span><span style="color:#89DDFF;">&gt;,</span></span>
<span class="line"><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// è·å–è¿˜æ²¡æœ‰æ³¨å†Œè¿‡çš„ å­åº”ç”¨</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// æ¯ä¸ªåº”ç”¨åªéœ€è¦æ³¨å†Œä¸€æ¬¡ï¼Œé¿å…å¤šæ¬¡è°ƒç”¨ registerMicroApps å‡½æ•°åŒæ—¶æ³¨å†Œäº†ç›¸åŒçš„åº”ç”¨</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">unregisteredApps</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">apps</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">filter</span><span style="color:#F07178;">(</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">app</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">!</span><span style="color:#A6ACCD;">microApps</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">some</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">registeredApp</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">registeredApp</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">name</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">app</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">name</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#676E95;font-style:italic;">//</span></span>
<span class="line"><span style="color:#F07178;">  )</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">microApps</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> [</span><span style="color:#89DDFF;">...</span><span style="color:#A6ACCD;">microApps</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">...</span><span style="color:#A6ACCD;">unregisteredApps</span><span style="color:#F07178;">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">unregisteredApps</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">forEach</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">app</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">name</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">activeRule</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">loader</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">noop</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">props</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">...</span><span style="color:#A6ACCD;">appConfig</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">app</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#82AAFF;">registerApplication</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#A6ACCD;">name</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#676E95;font-style:italic;">// å­åº”ç”¨åç§°ï¼Œå¿…é¡»å”¯ä¸€</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#82AAFF;">app</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">async</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">()</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;font-style:italic;">// 1. åŠ è½½å’Œè§£æ\`html\`èµ„æºï¼Œè·å–é¡µé¢ã€æ ·å¼èµ„æºé“¾æ¥ã€è„šæœ¬èµ„æºé“¾æ¥ä¸‰ç§æ•°æ®</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;font-style:italic;">// 2. å¯¹å¤–éƒ¨æ ·å¼èµ„æºï¼ˆcssï¼‰è¿›è¡ŒåŠ è½½å¤„ç†ï¼Œç”Ÿæˆ\`render\`å‡½æ•°</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;font-style:italic;">// 3. ç”Ÿæˆ \`js\`æ²™ç®±</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;font-style:italic;">// 4. åŠ è½½å¤–éƒ¨è„šæœ¬èµ„æºï¼ˆjsï¼‰ï¼Œä¸”è¿›è¡ŒåŒ…è£…ã€æ‰§è¡Œ</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;font-style:italic;">// 5. ä»å…¥å£æ–‡ä»¶é‡Œè·å–ç”Ÿå‘½å‘¨æœŸé’©å­å‡½æ•°ï¼š\`bootstrap\`ã€\`mount\`ã€\`unmount\`ï¼Œ</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;font-style:italic;">// ç„¶åå½“ä½œregisterApplicationçš„appå½¢å‚ä¸­çš„è¿”å›æ•°æ®ï¼Œå¦‚ä¸‹æ‰€ç¤º</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#82AAFF;">loader</span><span style="color:#F07178;">(</span><span style="color:#FF9CAC;">true</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;font-style:italic;">await</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">frameworkStartedDefer</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">promise</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">mount</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">...</span><span style="color:#A6ACCD;">otherMicroAppConfigs</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> (</span></span>
<span class="line"><span style="color:#F07178;">          </span><span style="color:#89DDFF;font-style:italic;">await</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">loadApp</span><span style="color:#F07178;">(</span></span>
<span class="line"><span style="color:#F07178;">            </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">name</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">props</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">...</span><span style="color:#A6ACCD;">appConfig</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#F07178;">            </span><span style="color:#A6ACCD;">frameworkConfiguration</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">            </span><span style="color:#A6ACCD;">lifeCycles</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#676E95;font-style:italic;">//</span></span>
<span class="line"><span style="color:#F07178;">          )</span></span>
<span class="line"><span style="color:#F07178;">        )()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">          mount</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> [</span></span>
<span class="line"><span style="color:#F07178;">            </span><span style="color:#C792EA;">async</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">()</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">loader</span><span style="color:#F07178;">(</span><span style="color:#FF9CAC;">true</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">            </span><span style="color:#89DDFF;">...</span><span style="color:#82AAFF;">toArray</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">mount</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#676E95;font-style:italic;">//</span></span>
<span class="line"><span style="color:#F07178;">            </span><span style="color:#C792EA;">async</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">()</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">loader</span><span style="color:#F07178;">(</span><span style="color:#FF9CAC;">false</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">          ]</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">          </span><span style="color:#89DDFF;">...</span><span style="color:#A6ACCD;">otherMicroAppConfigs</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;font-style:italic;">// å­åº”ç”¨æ¿€æ´»è·¯å¾„</span></span>
<span class="line"><span style="color:#F07178;">      activeWhen</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">activeRule</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;font-style:italic;">// éœ€è¦ä¼ é€’ç»™å­åº”ç”¨çš„æ•°æ®</span></span>
<span class="line"><span style="color:#F07178;">      customProps</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">props</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><h2 id="å¿«é€Ÿå­¦ä¹ ä¹¾å¤å®ç°æµç¨‹" tabindex="-1">å¿«é€Ÿå­¦ä¹ ä¹¾å¤å®ç°æµç¨‹ <a class="header-anchor" href="#å¿«é€Ÿå­¦ä¹ ä¹¾å¤å®ç°æµç¨‹" aria-hidden="true">#</a></h2><ul><li><a href="https://juejin.cn/post/7202246519080304697" target="_blank" rel="noreferrer">ä¸æ‡‚ qiankun åŸç†?è¿™ç¯‡æ–‡ç« äº”å¼ å›¾ç‰‡å¸¦ä½ è¿…é€Ÿé€šæ™“</a></li></ul><h3 id="qiankun-çš„æ•´ä¸ªæµç¨‹" tabindex="-1">qiankun çš„æ•´ä¸ªæµç¨‹ <a class="header-anchor" href="#qiankun-çš„æ•´ä¸ªæµç¨‹" aria-hidden="true">#</a></h3><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/3d0eb49c886b496e8ff36fb5060ba00d~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.awebp?" alt=""></p><h3 id="åŠ è½½è§£æ-html" tabindex="-1">åŠ è½½è§£æ html <a class="header-anchor" href="#åŠ è½½è§£æ-html" aria-hidden="true">#</a></h3><p>qiankun ä½¿ç”¨äº† import-html-entry è¿™ä¸ªåº“å»å¤„ç† html èµ„æºï¼Œå¹¶é€šè¿‡æ­£åˆ™å°† html è§£æä¸ºä¸‹é¢å‡ ä¸ªæ¨¡å—</p><ul><li>template</li><li>scripts</li><li>entry</li><li>styles</li></ul><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e6440eadfdde409ebf67e7949e25e14c~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.awebp?" alt=""></p><h3 id="css-å¤–éƒ¨æ ·å¼å¤„ç†" tabindex="-1">css å¤–éƒ¨æ ·å¼å¤„ç† <a class="header-anchor" href="#css-å¤–éƒ¨æ ·å¼å¤„ç†" aria-hidden="true">#</a></h3><p>æ¯”å¦‚å…¥å£çš„ html æ–‡ä»¶ä¸­å¼•å…¥äº† main.css, åœ¨ html è§£æçš„æ—¶å€™ï¼Œå¯¹åº”çš„ css æ–‡ä»¶å¼•å…¥ä»£ç åœ¨ template é‡Œé¢ä¼šå…ˆè¢«æ³¨é‡Šæ‰å¹¶æ‰“ä¸Šæ ‡è®°</p><p>ç­‰ç¬¬ä¸€æ­¥è§£æå®Œæˆä¹‹åï¼Œå†å»è¯·æ±‚ styles é‡Œé¢çš„èµ„æºä¿¡æ¯ï¼Œåœ¨æˆåŠŸè·å–ååœ¨æ’å…¥åˆ° template ä¸­æ ‡è®°çš„åœ°æ–¹</p><p>æˆåŠŸåˆå¹¶ä¹‹åç”Ÿæˆæ–°çš„ templateï¼Œåœ¨æ ¹æ®æ–°çš„ template ç”Ÿæˆå“åº”çš„ render å‡½æ•°</p><p>render åœ¨æŠŠæˆ‘ä»¬çš„å­åº”ç”¨æŒ‚è½½åˆ°çˆ¶åº”ç”¨ä¸Šå¯¹åº”çš„èŠ‚ç‚¹ä¸Š</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/67ffc1e220624a91a92b9176e5e7c82b~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.awebp?" alt=""></p><h3 id="js-æ²™ç®±å¤„ç†" tabindex="-1">js æ²™ç®±å¤„ç† <a class="header-anchor" href="#js-æ²™ç®±å¤„ç†" aria-hidden="true">#</a></h3><p>js æ²™ç®± <code>ç”¨äºéš”ç¦»åº”ç”¨é—´çš„ window ç¯å¢ƒï¼Œé˜²æ­¢å­åº”ç”¨åœ¨æ‰§è¡Œä»£ç æœŸé—´å½±å“äº†å…¶ä»–åº”ç”¨è®¾ç½®åœ¨ window ä¸Šçš„å±æ€§</code></p><p>qiankun ä¸ºæˆ‘ä»¬æä¾›äº† 3 ç§ js æ²™ç®±</p><table><thead><tr><th></th><th>åç§°</th><th>åŸç†ç®€è¿°</th></tr></thead><tbody><tr><td><code>SnapshotSandbox</code></td><td>å¿«ç…§æ²™ç®±</td><td>ä¿å­˜å¿«ç…§ï¼Œdiff</td></tr><tr><td><code>LegacySandbox</code></td><td>å•ä¾‹æ²™ç®±</td><td>window å˜åŒ–ç›‘å¬ + diff</td></tr><tr><td><code>ProxySandbox</code></td><td>å¤šä¾‹æ²™ç®±</td><td>proxy ä»£ç†å’Œ window ç›¸åŒå±æ€§æ–¹æ³•çš„çº¯å¯¹è±¡</td></tr></tbody></table><blockquote><p>å…·ä½“å·®åˆ«å¯ä»¥çœ‹ä¸‹æ–‡çš„ æ²™ç®±å®ç°æ€è·¯ éƒ¨åˆ†</p></blockquote><p>ProxySandboxï¼š</p><ol><li>window ä¸Šçš„å…¨éƒ¨å±æ€§å¤åˆ¶åˆ°ä¸€ä¸ªçº¯å¯¹è±¡é‡Œé¢</li><li>ä½¿ç”¨ proxy ä»£ç†è¿™ä¸ªçº¯å¯¹è±¡ <ul><li>å­åº”ç”¨å¦‚æœè®¿é—®çš„å±æ€§æ˜¯åœ¨è®¾ç½®çš„ç™½åå•ï¼ˆæ¯”å¦‚ window ä¸ŠåŸæœ¬å°±æœ‰çš„å±æ€§ã€æ–¹æ³•ï¼‰é‡Œé¢çš„è¯ï¼Œé‚£ä¼šå…ˆæŠŠ window ä¸ŠåŸå…ˆçš„å€¼å¤åˆ¶ä¸€ä»½ï¼Œå­åº”ç”¨å¯ä»¥ç›´æ¥è®¿é—®/ä¿®æ”¹ window ä¸Šå¯¹åº”çš„å±æ€§ï¼Œå­åº”ç”¨é”€æ¯æ—¶å†æŠŠå¤‡ä»½çš„æ•°æ®é‡æ–°ç»™ window ä¸Šå¯¹çš„å¯¹åº”å±æ€§èµ‹å€¼</li><li>å¦‚æœä¸åœ¨ç™½åå•é‡Œé¢ï¼Œè®¿é—® / ä¿®æ”¹çš„å°±æ˜¯çº¯å¯¹è±¡é‡Œçš„æ•°æ®ï¼Œwindow ä¸Šçš„å±æ€§ä¸ä¼šè¢«è®¿é—® / æ”¹å˜</li></ul></li></ol><blockquote><p>ProxySandbox ç¼ºç‚¹ï¼šè¿™ç§æ²™ç®±åªèƒ½éš”ç¦» Window çš„ä¸€çº§å±æ€§ã€‚å› ä¸º Proxy åªä¼šæ•è·åˆ°ä¸€çº§å±æ€§çš„å¢åˆ æ”¹ï¼Œä¸èƒ½æ•è·åˆ°äºŒçº§ä»¥ä¸Šå±æ€§çš„å˜åŠ¨</p></blockquote><h3 id="åŠ è½½å¤–éƒ¨-js-èµ„æº" tabindex="-1">åŠ è½½å¤–éƒ¨ js èµ„æº <a class="header-anchor" href="#åŠ è½½å¤–éƒ¨-js-èµ„æº" aria-hidden="true">#</a></h3><p>ä½¿ç”¨ä¸Šä¸€æ­¥çš„æ²™ç®±å¯¹è¯·æ±‚åˆ°çš„ js èµ„æºè¿›è¡ŒåŒ…è£…</p><p>ä¾‹å¦‚æˆ‘ä»¬è¦è¯·æ±‚ä¸€ä¸ª <code>http://xxxx:xxx/main.bunlde.xxx.js</code> æ–‡ä»¶</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">// main.bunlde.xxx.js</span></span>
<span class="line"><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">a</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// ...</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#82AAFF;">b</span><span style="color:#F07178;">()</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">b</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// ...</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#82AAFF;">a</span><span style="color:#A6ACCD;">()</span></span>
<span class="line"></span></code></pre></div><p>ä½¿ç”¨æ²™ç®±å°è£…</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;">(</span><span style="color:#C792EA;">function</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">window</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">self</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">globalThis</span><span style="color:#89DDFF;">){</span></span>
<span class="line"><span style="color:#89DDFF;">	</span><span style="color:#676E95;font-style:italic;">// with è¯­å¥çš„ä¸»è¦ä½œç”¨æ˜¯å°†ä»£ç çš„ä½œç”¨åŸŸè®¾ç½®åˆ°ä¸€ä¸ªç‰¹å®šçš„å¯¹è±¡ä¸­ï¼Œç®€åŒ–å¤šæ¬¡ç¼–å†™åŒä¸€ä¸ªå¯¹è±¡çš„å·¥ä½œ</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">with</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">window</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">		</span><span style="color:#C792EA;">function</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">a</span><span style="color:#89DDFF;">()</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">			</span><span style="color:#676E95;font-style:italic;">// ...</span></span>
<span class="line"><span style="color:#F07178;">			</span><span style="color:#82AAFF;">b</span><span style="color:#F07178;">()</span></span>
<span class="line"><span style="color:#F07178;">		</span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">		</span><span style="color:#C792EA;">function</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">b</span><span style="color:#89DDFF;">()</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">			</span><span style="color:#676E95;font-style:italic;">// ...</span></span>
<span class="line"><span style="color:#F07178;">		</span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">		</span><span style="color:#82AAFF;">a</span><span style="color:#F07178;">()</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">bind</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">window</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">proxy</span><span style="color:#F07178;">)(</span></span>
<span class="line"><span style="color:#F07178;">	</span><span style="color:#A6ACCD;">window</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">proxy</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">	</span><span style="color:#A6ACCD;">window</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">proxy</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">	</span><span style="color:#A6ACCD;">window</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">proxy</span></span>
<span class="line"><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4613f4f4e96c4b569ed929d81d8842db~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.awebp?" alt=""></p><h3 id="ä»å…¥å£æ–‡ä»¶è·å–ç”Ÿå‘½å‘¨æœŸé’©å­å‡½æ•°" tabindex="-1">ä»å…¥å£æ–‡ä»¶è·å–ç”Ÿå‘½å‘¨æœŸé’©å­å‡½æ•° <a class="header-anchor" href="#ä»å…¥å£æ–‡ä»¶è·å–ç”Ÿå‘½å‘¨æœŸé’©å­å‡½æ•°" aria-hidden="true">#</a></h3><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/44b96e3a18114c88ab0621db2cf4f103~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.awebp?" alt=""></p><h2 id="qiankun-js-æ²™ç®±å…·ä½“å®ç°æ€è·¯" tabindex="-1">qiankun js æ²™ç®±å…·ä½“å®ç°æ€è·¯ <a class="header-anchor" href="#qiankun-js-æ²™ç®±å…·ä½“å®ç°æ€è·¯" aria-hidden="true">#</a></h2><p>qiankun æ²™ç®±å‘å±•æ—¶é—´çº¿</p><ul><li><a href="https://juejin.cn/post/7148075486403362846" target="_blank" rel="noreferrer">Qiankun åŸç†â€”â€”JS æ²™ç®±æ˜¯æ€ä¹ˆåšéš”ç¦»çš„</a></li></ul><p>qiankun ä¸ºæˆ‘ä»¬æä¾›äº† 3 ç§ js æ²™ç®±</p><blockquote><p><code>SnapshotSandbox</code> --&gt; ä¼˜åŒ– --&gt; <code>LegacySandbox</code> --&gt; es6 çš„ proxy æ™®åŠï¼Œå†æ¬¡ä¼˜åŒ– --&gt; <code>ProxySandbox</code></p></blockquote><h3 id="snapshotsandbox-å¿«ç…§æ²™ç®±" tabindex="-1"><code>SnapshotSandbox</code> å¿«ç…§æ²™ç®± <a class="header-anchor" href="#snapshotsandbox-å¿«ç…§æ²™ç®±" aria-hidden="true">#</a></h3><ul><li>å°†åŸæœ¬çš„ window ä¸Šçš„å±æ€§å¤åˆ¶å‡ºæ¥ä¸€ä»½å¦å¤–ä¿å­˜</li><li>å­åº”ç”¨ä¿®æ”¹ window ä¸Šçš„å±æ€§</li><li>å­åº”ç”¨å¸è½½ï¼Œdiff window å’Œä¹‹å‰å¦å¤–ä¿å­˜çš„é‚£ä»½æ•°æ®ï¼Œæ‰¾å‡º diff ç»“æœï¼Œä¿å­˜ diff ç»“æœ</li><li>ä½¿ç”¨å¤‡ä»½æ•°æ®æ¢å¤åŸå…ˆ window ä¸Šçš„å±æ€§</li><li>å­åº”ç”¨å†æ¬¡æŒ‚è½½æ—¶ï¼Œå°†ä¹‹å‰ä¿å­˜çš„ diff ç»“æœé‡æ–°èµ‹å€¼åˆ° window ä¸Š</li></ul><blockquote><p>ç¼ºç‚¹ï¼šå¦‚æœç»™ window ä¸Šè‡ªå®šä¹‰äº†ä¸Šåƒä¸ªå±æ€§ï¼Œé‚£ä¹ˆæ¯æ¬¡å­åº”ç”¨æŒ‚è½½ã€å¸è½½æ¯æ¬¡ diff éƒ½è¦èŠ±è´¹è¾ƒå¤§çš„æ€§èƒ½å¼€é”€ï¼Œè€Œä¸”åŒä¸€æ—¶é—´å†…åªèƒ½æœ‰å­˜åœ¨ä¸€ä¸ªå­åº”ç”¨ï¼Œè‹¥é¡µé¢éœ€è¦åŒæ—¶å‡ºç°ä¸¤ä¸ªå­åº”ç”¨åˆ™ä¼šå‡ºç°å¼‚å¸¸ï¼Œç®€å•æ¦‚æ‹¬ä¼š<code>æ±¡æŸ“å…¨å±€ window</code></p></blockquote><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/20621cb0fcad4b079473bba57cbece43~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.awebp" alt=""></p><h3 id="legacysandbox-å•ä¾‹æ²™ç®±" tabindex="-1"><code>LegacySandbox</code> å•ä¾‹æ²™ç®± <a class="header-anchor" href="#legacysandbox-å•ä¾‹æ²™ç®±" aria-hidden="true">#</a></h3><p>é’ˆå¯¹ä¸Šé¢æ¯æ¬¡éƒ½éœ€è¦å¤§é‡ diff æ“ä½œå¸¦æ¥çš„æ€§èƒ½æ¶ˆè€—ï¼Œqiankun æä¾›äº†å¦ä¸€ç§æ²™ç®±å®ç°æ–¹å¼ï¼Œå°±æ˜¯ç›‘å¬ window ä¸Šçš„ä¿®æ”¹æ¥è®°å½• diff å†…å®¹</p><ul><li>å­åº”ç”¨ä¿®æ”¹ window å±æ€§ <ul><li>ä¿®æ”¹çš„æ˜¯åŸæœ¬å°±æœ‰çš„å±æ€§ <ul><li>åˆ†åˆ«è®°å½•æ–°çš„å€¼å’Œæ—§çš„å€¼</li></ul></li><li>æ–°å¢çš„å±æ€§ <ul><li>è®°å½•ä¸‹æ¥</li></ul></li></ul></li><li>å­åº”ç”¨å¸è½½æ—¶ <ul><li>ç›´æ¥ä» window ä¸ŠæŠŠå‰é¢æ–°å¢çš„å±äºç§»é™¤</li><li>å¯¹äºåŸæœ¬å°±æœ‰çš„å±æ€§ï¼Œä½¿ç”¨ä¿å­˜çš„æ—§å€¼ç›´æ¥æ›¿æ¢</li></ul></li></ul><blockquote><p>ç¼ºç‚¹ï¼šå’Œå¿«ç…§æ²™ç®±ä¸€æ ·ï¼ŒåŒæ ·æ˜¯ä¼š <code>æ±¡æŸ“å…¨å±€ window</code> ä¸”åªèƒ½å­˜åœ¨å•ä¾‹å­åº”ç”¨</p></blockquote><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f7ad2165ee3a4c68aab88a59a303d182~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.awebp" alt=""></p><h3 id="proxysandbox-å¤šä¾‹æ²™ç®±" tabindex="-1"><code>ProxySandbox</code> å¤šä¾‹æ²™ç®± <a class="header-anchor" href="#proxysandbox-å¤šä¾‹æ²™ç®±" aria-hidden="true">#</a></h3><p>ä¸ºäº†è§£å†³åªèƒ½ä½¿ç”¨å•ä¾‹çš„é—®é¢˜ï¼Œqiankun åˆæå‡ºäº†å¦ä¸€ç§æ²™ç®±å½¢å¼â€”â€”ä»£ç†æ²™ç®±</p><p>ä¸ºæ¯ä¸ªå­åº”ç”¨å•ç‹¬ä»£ç†ä¸€ä¸ª window å¯¹è±¡ï¼Œå¤§è‡´å®ç°å¯ä»¥çœ‹å‰é¢ <code>[js æ²™ç®±å¤„ç†]</code> éƒ¨åˆ†</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a6aebde8492943bba6420a0027f09027~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.awebp" alt=""></p><h3 id="js-æ²™ç®±æ€»ç»“" tabindex="-1">js æ²™ç®±æ€»ç»“ <a class="header-anchor" href="#js-æ²™ç®±æ€»ç»“" aria-hidden="true">#</a></h3><ul><li>SnapshotSandboxï¼šè®°å½• window å¯¹è±¡ï¼Œæ¯æ¬¡ unmount éƒ½è¦å’Œå¾®åº”ç”¨çš„ç¯å¢ƒè¿›è¡Œ Diff</li><li>LegacySandboxï¼šåœ¨å¾®åº”ç”¨ä¿®æ”¹ <a href="http://window.xxx" target="_blank" rel="noreferrer">window.xxx</a> æ—¶ç›´æ¥è®°å½• Diffï¼Œå°†å…¶ç”¨äºç¯å¢ƒæ¢å¤</li><li>ProxySandboxï¼šä¸ºæ¯ä¸ªå¾®åº”ç”¨åˆ†é…ä¸€ä¸ª fakeWindowï¼Œå½“å¾®åº”ç”¨æ“ä½œ window æ—¶ï¼Œå…¶å®æ˜¯åœ¨ fakeWindow ä¸Šæ“ä½œ</li></ul><h2 id="qiankun-css-æ²™ç®±å…·ä½“å®ç°æ€è·¯" tabindex="-1">qiankun css æ²™ç®±å…·ä½“å®ç°æ€è·¯ <a class="header-anchor" href="#qiankun-css-æ²™ç®±å…·ä½“å®ç°æ€è·¯" aria-hidden="true">#</a></h2><blockquote><p><code>qiankun çš„æ²™ç®±å¯ä»¥ç¡®ä¿å•å®ä¾‹åœºæ™¯å­åº”ç”¨ä¹‹é—´çš„æ ·å¼éš”ç¦»ï¼Œä½†æ˜¯æ— æ³•ç¡®ä¿ä¸»åº”ç”¨è·Ÿå­åº”ç”¨ã€æˆ–è€…å¤šå®ä¾‹åœºæ™¯çš„å­åº”ç”¨æ ·å¼éš”ç¦»ã€‚</code></p></blockquote><h3 id="shadow-dom-æ²™ç®±" tabindex="-1"><code>shadow Dom</code> æ²™ç®± <a class="header-anchor" href="#shadow-dom-æ²™ç®±" aria-hidden="true">#</a></h3><p><code>strictStyleIsolation: true</code></p><ul><li><a href="https://developer.mozilla.org/zh-CN/docs/Web/Web_Components/Using_shadow_DOM" target="_blank" rel="noreferrer">MDN-shadow DOM</a></li><li><a href="https://segmentfault.com/a/1190000019115050" target="_blank" rel="noreferrer">æ·±å…¥ç†è§£ Shadow DOM v1</a></li></ul><div class="warning custom-block"><p class="custom-block-title">shadow Dom</p><ul><li>å°è£…</li></ul><p>å°è£…æ˜¯é¢å‘å¯¹è±¡ç¼–ç¨‹çš„åŸºæœ¬ç‰¹æ€§ï¼Œå®ƒä½¿ç¨‹åºå‘˜èƒ½å¤Ÿé™åˆ¶å¯¹æŸäº›å¯¹è±¡ç»„ä»¶çš„æœªæˆæƒè®¿é—®ã€‚</p><p>åœ¨æ­¤å®šä¹‰ä¸‹ï¼Œå¯¹è±¡ä»¥å…¬å…±è®¿é—®æ–¹æ³•çš„å½¢å¼æä¾›æ¥å£ä½œä¸ºä¸å…¶æ•°æ®äº¤äº’çš„æ–¹å¼ã€‚è¿™æ ·å¯¹è±¡çš„å†…éƒ¨è¡¨ç¤ºä¸èƒ½ç›´æ¥è¢«å¯¹è±¡çš„å¤–éƒ¨è®¿é—®ã€‚</p><ul><li>Shadow DOM</li></ul><p>Shadow DOM å°†æ­¤æ¦‚å¿µå¼•å…¥ HTMLï¼Œå®ƒå…è®¸ä½ å°†éšè—çš„ï¼Œåˆ†ç¦»çš„ DOM é“¾æ¥åˆ°å…ƒç´ ï¼Œè¿™æ„å‘³ç€ä½ å¯ä»¥ä½¿ç”¨ HTML å’Œ CSS çš„æœ¬åœ°èŒƒå›´ã€‚</p><p>ç°åœ¨å¯ä»¥ç”¨æ›´é€šç”¨çš„ CSS é€‰æ‹©å™¨è€Œä¸å¿…æ‹…å¿ƒå‘½åå†²çªï¼Œå¹¶ä¸”æ ·å¼ä¸å†æ³„æ¼æˆ–è¢«åº”ç”¨äºä¸æ°å½“çš„å…ƒç´ ã€‚</p></div><p>é€šå¸¸æˆ‘ä»¬å°†æ­£å¸¸çš„ dom èŠ‚ç‚¹å«åš light domï¼Œç”¨äºåŒºåˆ†æ­£å¸¸ dom å’Œ shadow dom</p><p>ç¼ºç‚¹ï¼š</p><ul><li>ç»„ä»¶åº“é—®é¢˜ï¼Œæ¯”å¦‚å¸¸è§çš„å¼¹çª—ã€æç¤ºæ¡ç­‰ï¼Œç»„ä»¶åº“ä¸€èˆ¬éƒ½æ˜¯æŒ‚è½½åˆ° body ä¸‹é¢çš„ï¼Œä½†æ˜¯ shadow ä¼šéš”ç¦» cssï¼Œå¯¼è‡´å­åº”ç”¨é‡Œå¯¹è¿™äº›æŒ‚è½½åœ¨ body ä¸‹çš„ç»„ä»¶å¤±å»æ ·å¼æ§åˆ¶</li><li>äº‹ä»¶ä»£ç†é—®é¢˜ï¼Œå¦‚ react æ˜¯é€šè¿‡è‡ªå·±çš„åˆæˆäº‹ä»¶æœºåˆ¶å¤„ç†äº‹ä»¶çš„ï¼Œå³æ‰€æœ‰äº‹ä»¶éƒ½è¦å†’æ³¡åˆ° body å…ƒç´ æ¥è¿›è¡Œå¤„ç†ï¼Œä½† shadow dom åŒ…è£¹çš„å…ƒç´ å…¶å¯¹åº”çš„äº‹ä»¶ä¸ä¼šå†’æ³¡åˆ° body</li></ul><h3 id="scoped-css-æ²™ç®±" tabindex="-1"><code>scoped Css</code> æ²™ç®± <a class="header-anchor" href="#scoped-css-æ²™ç®±" aria-hidden="true">#</a></h3><p><code>experimentalStyleIsolation: true</code></p><p>qiankun ä¼šæ”¹å†™å­åº”ç”¨æ‰€æ·»åŠ çš„æ ·å¼ï¼Œä¸ºæ‰€æœ‰æ ·å¼è§„åˆ™å¢åŠ ä¸€ä¸ªç‰¹æ®Šçš„é€‰æ‹©å™¨è§„åˆ™æ¥é™å®šå…¶å½±å“èŒƒå›´</p><p>ç±»ä¼¼å¦‚ä¸‹ï¼š</p><div class="language-css"><button title="Copy Code" class="copy"></button><span class="lang">css</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">/* æˆ‘ä»¬è‡ªå·±å†™çš„ css ç±»å */</span></span>
<span class="line"><span style="color:#89DDFF;">.</span><span style="color:#FFCB6B;">app-main</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#B2CCD6;">font-size</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">14px</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">/* è½¬åŒ–ä¹‹åçš„ css ç±»å */</span></span>
<span class="line"><span style="color:#FFCB6B;">div</span><span style="color:#89DDFF;">[</span><span style="color:#C792EA;">data-qiankun-å­åº”ç”¨åç§°</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">.</span><span style="color:#FFCB6B;">app-main</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#B2CCD6;">font-size</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">14px</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><p>è¿™ä¸ªå°±æœ‰ç‚¹æƒ³ vue çš„ css scoped äº†</p><p>ç¼ºç‚¹ï¼š</p><ul><li>@keyframes , @font-face , @import , @page ä¸è¢«æ”¯æŒ</li><li>å­åº”ç”¨ css ä¸­çš„ var å˜é‡ä¼šä¸¢å¤±</li><li>åŒ shadow domï¼Œç»„ä»¶åº“é‚£äº›æŒ‚è½½åœ¨ body ä¸‹çš„ç»„ä»¶æ ·å¼ä¸¢å¤±</li></ul><h3 id="qiankun-css-è§£å†³æ–¹æ¡ˆ" tabindex="-1">qiankun css è§£å†³æ–¹æ¡ˆ <a class="header-anchor" href="#qiankun-css-è§£å†³æ–¹æ¡ˆ" aria-hidden="true">#</a></h3><ul><li>vueï¼šå¯ä»¥ä½¿ç”¨è‡ªå·±çš„ css scoped å‡å°‘æ ·å¼å†²çªï¼Œé’ˆå¯¹å°‘éƒ¨åˆ†å¼‚å¸¸æ ·å¼å¯ä»¥é’ˆå¯¹æ€§ä¿®æ”¹</li><li>reactï¼š ä½¿ç”¨ css module ä»£æ›¿ï¼Œå¦‚ xxx.module.less / xxx.module.scss / xxx.module.css</li><li>ä½¿ç”¨ tailwind / windicss / unocss ç­‰åŸå­åŒ–çš„ css æ¡†æ¶</li></ul>`,83),e=[o];function t(c,r,i,y,F,D){return a(),n("div",null,e)}const C=s(p,[["render",t]]);export{A as __pageData,C as default};
